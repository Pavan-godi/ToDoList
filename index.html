<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Todo Flow</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f7fa;
      display: flex;
      justify-content: center;
      padding: 30px;
      margin: 0;
    }
    .app {
      background: #fff;
      padding: 20px;
      border-radius: 15px;
      width: 400px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    h1 { text-align: center; }
    .task-input { display: flex; gap: 5px; margin-bottom: 15px; }
    .task-input input, .task-input select, .task-input button {
      padding: 8px; border-radius: 8px; border: 1px solid #ccc;
    }
    #addTaskBtn { background: #4CAF50; color: white; border: none; cursor: pointer; }
    #addTaskBtn:hover { background: #45a049; }
    .filters { display: flex; gap: 5px; margin-bottom: 15px; }
    #taskList { list-style: none; padding: 0; }
    .task { display: flex; justify-content: space-between; background: #f9f9f9;
      margin-bottom: 8px; padding: 10px; border-radius: 10px; }
    .task.completed { text-decoration: line-through; background: #d3ffd3; }
    .stats { margin-top: 15px; }
    .actions { margin-top: 15px; display: flex; justify-content: space-between; }
  </style>
</head>
<body>
  <div class="app">
    <h1>🌟 Todo Flow</h1>
    <div class="task-input">
      <input type="text" id="taskTitle" placeholder="✍️ Add a new task...">
      <input type="date" id="taskDate">
      <select id="taskPriority">
        <option value="low">🟢 Low</option>
        <option value="medium">🟡 Medium</option>
        <option value="high">🔴 High</option>
      </select>
      <button id="addTaskBtn">➕ Add</button>
    </div>
    <div class="filters">
      <input type="text" id="searchBox" placeholder="🔍 Search tasks...">
      <select id="filterStatus">
        <option value="all">All</option>
        <option value="pending">Pending</option>
        <option value="completed">Completed</option>
      </select>
      <select id="sortTasks">
        <option value="newest">Newest First</option>
        <option value="oldest">Oldest First</option>
        <option value="due">By Due Date</option>
        <option value="priority">By Priority</option>
      </select>
    </div>
    <ul id="taskList"></ul>
    <div class="stats">
      <p>Total: <span id="totalTasks">0</span></p>
      <p>Completed: <span id="completedTasks">0</span></p>
      <p>Overdue: <span id="overdueTasks">0</span></p>
    </div>
    <div class="actions">
      <button id="exportBtn">📤 Export</button>
      <input type="file" id="importFile" hidden>
      <button id="importBtn">📥 Import</button>
    </div>
  </div>
  <script>
    let tasks = JSON.parse(localStorage.getItem("tasks")) || [];
    const taskTitle = document.getElementById("taskTitle");
    const taskDate = document.getElementById("taskDate");
    const taskPriority = document.getElementById("taskPriority");
    const addTaskBtn = document.getElementById("addTaskBtn");
    const taskList = document.getElementById("taskList");
    const totalTasks = document.getElementById("totalTasks");
    const completedTasks = document.getElementById("completedTasks");
    const overdueTasks = document.getElementById("overdueTasks");
    const searchBox = document.getElementById("searchBox");
    const filterStatus = document.getElementById("filterStatus");
    const sortTasks = document.getElementById("sortTasks");
    const exportBtn = document.getElementById("exportBtn");
    const importBtn = document.getElementById("importBtn");
    const importFile = document.getElementById("importFile");

    function saveTasks() { localStorage.setItem("tasks", JSON.stringify(tasks)); }
    function renderTasks() {
      taskList.innerHTML = "";
      let filteredTasks = [...tasks];
      const query = searchBox.value.toLowerCase();
      filteredTasks = filteredTasks.filter(t => t.title.toLowerCase().includes(query));
      if (filterStatus.value === "completed") filteredTasks = filteredTasks.filter(t => t.completed);
      else if (filterStatus.value === "pending") filteredTasks = filteredTasks.filter(t => !t.completed);
      if (sortTasks.value === "newest") filteredTasks.sort((a,b)=>b.id-a.id);
      else if (sortTasks.value === "oldest") filteredTasks.sort((a,b)=>a.id-b.id);
      else if (sortTasks.value === "due") filteredTasks.sort((a,b)=>new Date(a.due||"2100-01-01")-new Date(b.due||"2100-01-01"));
      else if (sortTasks.value === "priority") {
        const order={high:1,medium:2,low:3}; filteredTasks.sort((a,b)=>order[a.priority]-order[b.priority]);
      }
      filteredTasks.forEach(task=>{
        const li=document.createElement("li");
        li.className=`task ${task.completed?"completed":""}`;
        li.innerHTML=`
          <span>
            <input type="checkbox" ${task.completed?"checked":""} onclick="toggleTask(${task.id})">
            ${task.title} (${task.priority}) ${task.due?"📅 "+task.due:""}
          </span>
          <button onclick="deleteTask(${task.id})">❌</button>
        `;
        taskList.appendChild(li);
      });
      totalTasks.textContent=tasks.length;
      completedTasks.textContent=tasks.filter(t=>t.completed).length;
      overdueTasks.textContent=tasks.filter(t=>t.due&&!t.completed&&new Date(t.due)<new Date()).length;
    }
    function addTask(){
      if(taskTitle.value.trim()==="")return;
      const task={id:Date.now(),title:taskTitle.value,due:taskDate.value||null,priority:taskPriority.value,completed:false};
      tasks.push(task); saveTasks(); renderTasks();
      taskTitle.value=""; taskDate.value="";
    }
    function toggleTask(id){const task=tasks.find(t=>t.id===id);task.completed=!task.completed;saveTasks();renderTasks();}
    function deleteTask(id){tasks=tasks.filter(t=>t.id!==id);saveTasks();renderTasks();}
    exportBtn.addEventListener("click",()=>{const blob=new Blob([JSON.stringify(tasks)],{type:"application/json"});const link=document.createElement("a");link.href=URL.createObjectURL(blob);link.download="tasks.json";link.click();});
    importBtn.addEventListener("click",()=>importFile.click());
    importFile.addEventListener("change",e=>{const file=e.target.files[0];if(!file)return;const reader=new FileReader();reader.onload=e=>{tasks=JSON.parse(e.target.result);saveTasks();renderTasks();};reader.readAsText(file);});
    addTaskBtn.addEventListener("click",addTask);
    searchBox.addEventListener("input",renderTasks);
    filterStatus.addEventListener("change",renderTasks);
    sortTasks.addEventListener("change",renderTasks);
    renderTasks();
  </script>
</body>
</html>
